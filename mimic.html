<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="src/mimic/styles.css" />
    <script src="src/mimic/mimic.ts" type="module"></script>
  </head>
  <body>
    <p>Regular chests tell the truth, Mimics lie</p>
    <div
      x-data="{width: $store.width, height: $store.height, mimicCount: $store.mimicCount}"
    >
      <label for="width">Width</label>
      <input type="number" id="width" min="1" class="border" x-model="width" />
      <label for="height">Height</label>
      <input
        type="number"
        id="height"
        class="border"
        min="1"
        x-model="height"
      />
      <label for="mimiccount">Mimics</label>
      <input
        type="number"
        id="mimiccount"
        class="border"
        min="0"
        :max="width * height"
        x-model="mimicCount"
      />
      <button
        class="border rounded"
        @click="() => {
          const newMimicCount = Math.min(mimicCount, width * height);
          mimicCount = newMimicCount;
          $store.generate(width, height, newMimicCount);
          $dispatch('regenerate');
        }"
      >
        Regenerate
      </button>
    </div>
    <div
      class="grid"
      x-data
      :style="`grid-template: repeat(${$store.height}, 200px) / repeat(${$store.width}, 200px)`"
    >
      <template x-for="chest in $store.chests.flat()">
        <div
          class="border flex flex-col justify-center content-center text-center"
          :class="`bg-${chest.color}-300`"
          x-data="{open: false}"
          @regenerate.window="open = false"
        >
          <p x-text="`Color: ${chest.color}`"></p>
          <p x-text="chest.statement"></p>
          <button class="border rounded" x-show="!open" @click="open = true">
            Open
          </button>
          <p x-show="open" x-text="chest.isMimic ? 'ded :3' : 'Safe!'"></p>
        </div>
      </template>
    </div>
  </body>
</html>
